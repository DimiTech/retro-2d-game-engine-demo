{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/app/infrastructure/Canvas.ts","webpack:///./src/app/domain/Map.ts","webpack:///./src/app/peripherals/Mouse.ts","webpack:///./src/app/audio/SoundFX.ts","webpack:///./src/app/audio/AudioContext.ts","webpack:///./src/main.ts","webpack:///./src/app/infrastructure/Game.ts","webpack:///./src/app/peripherals/Keyboard.ts","webpack:///./src/app/domain/Grid.ts","webpack:///./src/app/domain/factories/BoxFactory.ts","webpack:///./src/app/infrastructure/objects/primitives/Box.ts","webpack:///./src/app/infrastructure/objects/GameObject.ts","webpack:///./src/app/domain/Player.ts","webpack:///./src/app/domain/Projectile.ts","webpack:///./src/app/audio/Mixer.ts","webpack:///./src/app/audio/AudioBufferLoader.ts","webpack:///./src/app/audio/AudioLoader.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","CONFIG","Mouse_1","canvas","document","getElementById","width","CANVAS_WIDTH","height","CANVAS_HEIGHT","style","SCALE","context","getContext","Canvas","[object Object]","clearRect","box","strokeStyle","color","lineWidth","beginPath","moveTo","x","y","lineTo","TILE_SIZE","stroke","fillStyle","font","fillText","canvasX","getCanvasMouseX","canvasY","getCanvasMouseY","dx","this","center","dy","theta","Math","atan2","sightLineLength","cos","sin","offsetX","offsetY","canvasMouseX","canvasMouseY","dxEast","dxWest","yInt","xInt","tan","yIntEast","arc","PI","yIntWest","projectiles","playerX","playerY","forEach","rows","floor","cols","halfRows","halfCols","rowRemainder","colRemainder","getCanvasDomElement","default","offsetLeft","offsetTop","Canvas_1","BoxFactory_1","Map01","gameObjects","grid","player","loadMap","col","row","rowStart","colStart","gameObject","draw","map","length","createBox","Mouse","hijackRightClick","trackMouseOnCanvas","listenForLeftClicks","window","addEventListener","e","preventDefault","pageX","pageY","setShooting","Mixer_1","AudioContext_1","AudioBufferLoader_1","SoundFX","SMG","load","playSound","createBufferSource","buffer","SMG_INDEX","gainNode","createGain","gain","soundFxVolume","connect","destination","start","AudioContext","Keyboard_1","Grid_1","Map_1","Player_1","init","requestAnimationFrame","gameLoop","update","render","clear","keyCode","moving","up","left","down","right","Box_1","GameObject_1","drawBox","mapX","mapY","Projectile_1","SoundFX_1","rotation","maxSpeed","shooting","shootingCooldown","updateMapPosition","move","shoot","alive","splice","adjustCollisionWithGameObjects","xVel","abs","yVel","randomFactorX","random","randomFactorY","push","playSMG","drawPlayer","drawPlayerVisionRay","drawCrosshair","drawProjectiles","isShooting","directionX","directionY","speed","Mixer","musicVolume","_musicVolume","vol","_soundFxVolume","URI","Promise","resolve","reject","request","XMLHttpRequest","open","responseType","onload","decodeAudioData","response","send"],"mappings":"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","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","import * as CONFIG from '@app/configuration/config.json'\n\nimport Player from '@app/domain/Player'\nimport Projectile from '@app/domain/Projectile'\nimport Mouse from '@app/peripherals/Mouse'\nimport Box from './objects/primitives/Box'\n\nconst canvas = <HTMLCanvasElement> document.getElementById('canvas')\ncanvas.width  = CONFIG.CANVAS_WIDTH\ncanvas.height = CONFIG.CANVAS_HEIGHT\ncanvas.style.width  = CONFIG.SCALE !== 1 ? (CONFIG.SCALE * CONFIG.CANVAS_WIDTH ) + 'px' : 'auto'\ncanvas.style.height = CONFIG.SCALE !== 1 ? (CONFIG.SCALE * CONFIG.CANVAS_HEIGHT) + 'px' : 'auto'\nconst context = canvas.getContext('2d')\n\nexport default class Canvas {\n  public static rows = Math.floor(canvas.height / CONFIG.TILE_SIZE)\n  public static cols = Math.floor(canvas.width  / CONFIG.TILE_SIZE)\n  public static halfRows = Math.floor((canvas.height / 2) / CONFIG.TILE_SIZE)\n  public static halfCols = Math.floor((canvas.width  / 2) / CONFIG.TILE_SIZE)\n  public static rowRemainder = (canvas.height / 2) % CONFIG.TILE_SIZE\n  public static colRemainder = (canvas.width  / 2) % CONFIG.TILE_SIZE\n\n  public static center: { x: number, y: number } = {\n    x: CONFIG.CANVAS_WIDTH  / 2,\n    y: CONFIG.CANVAS_HEIGHT / 2,\n  }\n\n\tpublic static clear(): void {\n\t\tcontext.clearRect(0, 0, canvas.width, canvas.height)\n\t}\n\n  public static drawBox(box: Box): void {\n    context.strokeStyle = box.color\n    context.lineWidth = 1\n    context.beginPath()\n      // Draw box outline\n      context.moveTo( 0.5 + box.x,                     0.5 + box.y)\n      context.lineTo(-0.5 + box.x + CONFIG.TILE_SIZE,  0.5 + box.y)\n      context.lineTo(-0.5 + box.x + CONFIG.TILE_SIZE, -0.5 + box.y + CONFIG.TILE_SIZE)\n      context.lineTo( 0.5 + box.x                   , -0.5 + box.y + CONFIG.TILE_SIZE)\n      context.lineTo( 0.5 + box.x,                     0.5 + box.y)\n\n      // Draw 'x' accross the box\n      context.moveTo( 0.5 + box.x,                     0.5 + box.y)\n      context.lineTo(-0.5 + box.x + CONFIG.TILE_SIZE, -0.5 + box.y + CONFIG.TILE_SIZE)\n      context.moveTo(-0.5 + box.x + CONFIG.TILE_SIZE,  0.5 + box.y)\n      context.lineTo( 0.5 + box.x,                    -0.5 + box.y + CONFIG.TILE_SIZE)\n    context.stroke()\n  }\n  \n  public static drawPlayer(p: Player) {\n    context.beginPath()\n      context.fillStyle = '#00AA00'\n      context.font = \"10px Monospace\"\n\n      context.fillText(`p (${p.x}, ${p.y})`, 10, 20)\n      const canvasX: number = Canvas.getCanvasMouseX()\n      const canvasY: number = Canvas.getCanvasMouseY()\n      context.fillText(`m (${canvasX}, ${canvasY})`, 10, 32)\n      const dx = canvasX - this.center.x\n      const dy = canvasY - this.center.y\n      context.fillText(`d (${dx}, ${dy})`, 10, 44)\n      const theta = Math.atan2((dy), (dx))\n      context.fillText(`θ = ${theta}`, 10, 56)\n\n      context.strokeStyle = '#523DA5'\n      context.lineWidth = 2\n      context.moveTo(this.center.x, this.center.y)\n      context.lineTo(this.center.x + (p.sightLineLength * Math.cos(theta)), this.center.y + (p.sightLineLength * Math.sin(theta)))\n    context.stroke()\n  }\n\n  public static drawCrosshair(): void {\n    const canvasX: number = Canvas.getCanvasMouseX()\n    const canvasY: number = Canvas.getCanvasMouseY()\n    let offsetX, offsetY\n    context.strokeStyle = '#FFFFFF'\n    context.lineWidth = 0.5\n    context.beginPath()\n      // Top\n      offsetX =  0.5\n      offsetY = -1.5\n      context.moveTo(canvasX + offsetX, canvasY + offsetY)\n      offsetY = -3.5\n      context.lineTo(canvasX + offsetX, canvasY + offsetY)\n\n      // Bottom\n      offsetY = 2.5\n      context.moveTo(canvasX + offsetX, canvasY + offsetY)\n      offsetY = 4.5\n      context.lineTo(canvasX + offsetX, canvasY + offsetY)\n\n      // Left\n      offsetY =  0.5\n      offsetX = -3.5\n      context.moveTo(canvasX + offsetX, canvasY + offsetY)\n      offsetX = -1.5\n      context.lineTo(canvasX + offsetX, canvasY + offsetY)\n\n      // Right\n      offsetX = 2.5\n      context.moveTo(canvasX + offsetX, canvasY + offsetY)\n      offsetX = 4.5\n      context.lineTo(canvasX + offsetX, canvasY + offsetY)\n    context.stroke()\n  }\n\n  public static drawPlayerVisionRay(p: Player): void {\n    const canvasMouseX: number = Canvas.getCanvasMouseX()\n    const canvasMouseY: number = Canvas.getCanvasMouseY()\n    context.strokeStyle = '#FF4444'\n    context.lineWidth = 0.1\n    context.beginPath()\n      context.moveTo(this.center.x, this.center.y)\n      context.lineTo(canvasMouseX, canvasMouseY)\n    context.stroke()\n\n    const dx = this.getCanvasMouseX() - this.center.x\n    const dy = this.getCanvasMouseY() - this.center.y\n    const theta = Math.atan2((dy), (dx))\n    context.beginPath()\n      context.strokeStyle = '#FF4444'\n      context.lineWidth = 0.5\n\n      const dxEast = CONFIG.TILE_SIZE - (p.x % CONFIG.TILE_SIZE)\n      const dxWest = p.x % CONFIG.TILE_SIZE\n\n      if (theta >= 0) { // South\n        const yInt = (CONFIG.TILE_SIZE - (p.y % CONFIG.TILE_SIZE))\n        const xInt = (CONFIG.TILE_SIZE - (p.y % CONFIG.TILE_SIZE)) / Math.tan(theta)\n\n        // context.fillText(`p (${xInt}, ${yInt})`, 10, 40)\n\n        if (xInt > 0 && xInt > dxEast) {\n          // South East\n          const yIntEast = dxEast * Math.tan(theta)\n          context.arc(\n            this.center.x + dxEast,\n            this.center.y + yIntEast,\n            2, 0, (2 * Math.PI)\n          )\n        }\n        else if (xInt < 0 && -xInt > dxWest) {\n          // South West\n          const yIntWest = dxWest * Math.tan(Math.PI - theta)\n          context.arc(\n            this.center.x - dxWest,\n            this.center.y + yIntWest,\n            2, 0, (2 * Math.PI)\n          )\n        }\n        else { // South\n          context.arc(\n            this.center.x + xInt,\n            this.center.y + yInt,\n            2, 0, (2 * Math.PI)\n          )\n        }\n      } else { // North\n        const yInt = p.y % CONFIG.TILE_SIZE\n        const xInt = (p.y % CONFIG.TILE_SIZE) / Math.tan(-theta)\n\n        if (xInt > 0 && xInt > dxEast) {\n          // South East\n          const yIntEast = dxEast * Math.tan(-theta)\n          context.arc(\n            this.center.x + dxEast,\n            this.center.y - yIntEast,\n            2, 0, (2 * Math.PI)\n          )\n        }\n        else if (xInt < 0 && -xInt > dxWest) {\n          // South West\n          const yIntWest = dxWest * Math.tan(Math.PI - theta)\n          context.arc(\n            this.center.x - dxWest,\n            this.center.y + yIntWest,\n            2, 0, (2 * Math.PI)\n          )\n        }\n        else {\n          // South\n          context.arc(\n            this.center.x + xInt,\n            this.center.y - yInt,\n            2, 0, (2 * Math.PI)\n          )\n        }\n      }\n    context.stroke()\n  }\n\n  public static drawProjectiles (projectiles: Projectile[], playerX: number, playerY: number) {\n    context.fillStyle = '#FFFFFF'\n    context.lineWidth = 1\n    projectiles.forEach(p => {\n      context.beginPath()\n      context.arc(\n        p.x + this.center.x - playerX,\n        p.y + this.center.y - playerY,\n        2,\n        0,\n        (2 * Math.PI)\n      )\n      context.stroke()\n    })\n  }\n\n  public static getCanvasDomElement = (): HTMLCanvasElement => canvas\n  // TODO: Optimize by not calculating this many times\n  public static getCanvasMouseX = (): number => Math.floor((Mouse.x - canvas.offsetLeft) / CONFIG.SCALE)\n  public static getCanvasMouseY = (): number => Math.floor((Mouse.y - canvas.offsetTop ) / CONFIG.SCALE)\n}\n","import * as CONFIG from '@app/configuration/config.json'\n\nimport Grid from '@app/domain/Grid'\n\nimport Player from '@app/domain/Player'\nimport Canvas from '@app/infrastructure/Canvas'\nimport GameObject from '@app/infrastructure/objects/GameObject'\nimport BoxFactory from '@app/domain/factories/BoxFactory'\n\nimport * as Map01 from '@app/resources/maps/Map-01.json'\n\nexport const gameObjects: Array<GameObject[]> = []\n\nexport default class Map {\n  constructor(private grid: Grid, private player: Player) {\n    this.loadMap(Map01)\n  }\n\n  public draw(): void {\n    let offsetLeft = (this.player.x % CONFIG.TILE_SIZE) - Canvas.colRemainder\n    let offsetTop  = (this.player.y % CONFIG.TILE_SIZE) - Canvas.rowRemainder\n\n    // Correct negative offsets\n    // TODO: See if there is a cleaner way to solve this\n    if (this.player.col < 0) {\n      if (offsetLeft === -Canvas.colRemainder) {\n        offsetLeft = -(CONFIG.TILE_SIZE + Canvas.colRemainder)\n      }\n      offsetLeft += CONFIG.TILE_SIZE\n    }\n    if (this.player.row < 0) {\n      if (1 / offsetTop === -Infinity) {\n        offsetTop = -CONFIG.TILE_SIZE\n      }\n      offsetTop += CONFIG.TILE_SIZE\n    }\n\n    const rowStart = this.player.row - Canvas.halfRows\n    const colStart = this.player.col - Canvas.halfCols\n    let gameObject\n    for (let row = rowStart; row < rowStart + Canvas.rows + 1; ++row) {\n      for (let col = colStart; col < colStart + Canvas.cols + 1; ++col) {\n        if (gameObjects[row] && gameObjects[row][col]) {\n          gameObject = gameObjects[row][col]\n          gameObject.x = (col - colStart) * CONFIG.TILE_SIZE - offsetLeft\n          gameObject.y = (row - rowStart) * CONFIG.TILE_SIZE - offsetTop\n          gameObject.draw()\n        }\n      }\n    }\n  }\n\n  private loadMap(map: number[][]): void {\n    for (let row = 0; row < map.length; ++row) {\n      gameObjects[row] = []\n      for (let col = 0; col < map[row].length; ++col) {\n        switch (map[row][col]) {\n          case 1:\n            gameObjects[row][col] = BoxFactory.createBox('#572F17', row, col)\n            break\n          case 2:\n            gameObjects[row][col] = BoxFactory.createBox('#403550', row, col)\n            break\n          case 3:\n            gameObjects[row][col] = BoxFactory.createBox('#27531B', row, col)\n            break\n          default:\n            gameObjects[row][col] = null\n        }\n      }\n    }\n  }\n}\n","import Canvas from '@app/infrastructure/Canvas'\nimport Player from '@app/domain/Player'\n\nexport default class Mouse {\n\tpublic static x: number = 0\n\tpublic static y: number = 0\n  public static init(player: Player) {\n    this.hijackRightClick()\n    this.trackMouseOnCanvas()\n    this.listenForLeftClicks(player)\n  }\n\n  private static hijackRightClick(): void {\n    window.addEventListener('contextmenu', e => {\n      e.preventDefault()\n    }, false)\n  }\n\n  private static trackMouseOnCanvas(): void {\n    const canvas: HTMLCanvasElement = Canvas.getCanvasDomElement()\n    canvas.addEventListener('mousemove', e => {\n\t\t\tthis.x = e.pageX\n\t\t\tthis.y = e.pageY\n    }, false)\n  }\n\n  private static listenForLeftClicks(player: Player): void {\n    const canvas: HTMLCanvasElement = Canvas.getCanvasDomElement()\n    canvas.addEventListener('mousedown', e => {\n      player.setShooting(true)\n    }, false)\n    canvas.addEventListener('mouseup', e => {\n      player.setShooting(false)\n    }, false)\n  }\n}\n","import Mixer from './Mixer'\nimport context from './AudioContext'\nimport { load } from './AudioBufferLoader'\n\nexport default class SoundFX {\n  private static SMG: AudioBuffer[] = []\n  private static SMG_INDEX = 0\n\n  public static async load(): Promise<void> {\n    this.SMG[0] = await load('./audio/smg_1.wav')\n    this.SMG[1] = await load('./audio/smg_2.wav')\n    this.SMG[2] = await load('./audio/smg_3.wav')\n    this.SMG[3] = await load('./audio/smg_4.wav')\n    this.SMG[4] = await load('./audio/smg_5.wav')\n  }\n\n  public static playSMG(): void {\n    const playSound = context.createBufferSource()\n    playSound.buffer = this.SMG[this.SMG_INDEX]\n\n    const gainNode = context.createGain()\n    gainNode.gain.value = Mixer.soundFxVolume\n    playSound.connect(gainNode)\n\n    gainNode.connect(context.destination)\n\n    playSound.start()\n    this.SMG_INDEX = ++this.SMG_INDEX % this.SMG.length // Shuffle the SMG FX\n  }\n}\n","const context: AudioContext = new AudioContext()\n\nexport default context\n","import Game from '@app/infrastructure/Game'\n\nconst game: Game = new Game()\ngame.start()\n","import Canvas from '@app/infrastructure/Canvas'\nimport Mouse from '@app/peripherals/Mouse'\nimport Keyboard from '@app/peripherals/Keyboard'\nimport Grid from '@app/domain/Grid'\nimport Map from '@app/domain/Map'\nimport Player from '@app/domain/Player'\nimport AudioLoader from '@app/audio/AudioLoader'\n\n// Load all assets\nAudioLoader.load()\n\n// Initialize the game\nconst grid: Grid = new Grid()\nconst player: Player = new Player(128, 64)\nconst map: Map = new Map(grid, player)\n\nKeyboard.init(player)\nMouse.init(player)\n\nexport default class Game {\n  public start(): void {\n\t\twindow.requestAnimationFrame(() => this.gameLoop())\n  }\n\n\tprivate gameLoop(): void {\n\t\tthis.update()\n\t\tthis.render()\n\t\twindow.requestAnimationFrame(() => this.gameLoop())\n\t}\n\n  private update(): void {\n    player.update()\n  }\n\n  private render(): void {\n\t  Canvas.clear()\n    map.draw()\n    player.draw()\n  }\n}\n","import Player from '@app/domain/Player'\n\nexport default class Keyboard {\n  public static init(player: Player): void {\n    // TODO: Move Player logic to Player class\n    document.addEventListener('keydown', e => {\n      switch (e.keyCode) {\n        case 87: // w\n          player.moving.up = true\n          break\n        case 65: // a\n          player.moving.left = true\n          break\n        case 83: // s\n          player.moving.down = true\n          break\n        case 68: // d\n          player.moving.right = true\n          break\n        default:\n          break\n      }\n    })\n    document.addEventListener('keyup', e => {\n      switch (e.keyCode) {\n        case 87: // w\n          player.moving.up = false\n          break\n        case 65: // a\n          player.moving.left = false\n          break\n        case 83: // s\n          player.moving.down = false\n          break\n        case 68: // d\n          player.moving.right = false\n          break\n        default:\n          break\n      }\n    })\n  }\n}\n","import * as CONFIG from '@app/configuration/config.json'\n\nexport default class Grid {\n  rows: number = CONFIG.CANVAS_HEIGHT / CONFIG.TILE_SIZE\n  cols: number = CONFIG.CANVAS_WIDTH  / CONFIG.TILE_SIZE\n}\n","import * as CONFIG from '../../configuration/config.json'\n\nimport Box from '@app/infrastructure/objects/primitives/Box'\n\nexport default class BoxFactory {\n  public static createBox(color: string, row: number, col: number): Box {\n    return new Box(\n      color,\n      row,\n      col,\n      CONFIG.TILE_SIZE,\n      CONFIG.TILE_SIZE,\n    )\n  }\n}\n","import Canvas from '@app/infrastructure/Canvas'\nimport GameObject from '../GameObject'\n\nexport default class Box extends GameObject {\n  draw(): void {\n    Canvas.drawBox(this)\n  }\n}\n","import * as CONFIG from '@app/configuration/config.json'\n\nexport default abstract class GameObject {\n  public x: number\n  public y: number\n  public mapX: number\n  public mapY: number\n\n  constructor(\n    public color: string,\n    public row: number,\n    public col: number,\n    public width: number,\n    public height: number,\n  ) {\n    this.mapX = col * CONFIG.TILE_SIZE\n    this.mapY = row * CONFIG.TILE_SIZE\n  }\n\n  public abstract draw(): void\n}\n","import * as CONFIG from '@app/configuration/config.json'\nimport Canvas from '@app/infrastructure/Canvas'\n\nimport Projectile from '@app/domain/Projectile'\nimport { gameObjects } from '@app/domain/Map'\n\nimport SoundFX from '@app/audio/SoundFX'\n\nexport default class Player {\n  public rotation: number = 0\n  private maxSpeed = 4\n  public moving = {\n    left  : false,\n    right : false,\n    up    : false,\n    down  : false,\n  }\n  public row: number\n  public col: number\n  public sightLineLength = 10\n  private shooting = false\n  private shootingCooldown = 6\n  private projectiles: Projectile[] = []\n\n  constructor(\n    public x: number,\n    public y: number,\n  )\n  {\n    this.updateMapPosition()\n  }\n\n  public update(): void {\n    this.move()\n    this.shoot()\n    this.projectiles.forEach((p, i) => {\n      p.update(this.x, this.y)\n      if (p.alive === false) {\n        this.projectiles.splice(i, 1) // Remove the projectile\n      }\n    })\n  }\n\n  public move(): void {\n    if (this.moving.left) {\n      this.x -= this.maxSpeed\n    }\n    if (this.moving.right) {\n      this.x += this.maxSpeed\n    }\n    if (this.moving.up) {\n      this.y -= this.maxSpeed\n    }\n    if (this.moving.down) {\n      this.y += this.maxSpeed\n    }\n    this.adjustCollisionWithGameObjects()\n    this.updateMapPosition()\n  }\n\n  // TODO: Generalize collision physics\n  private adjustCollisionWithGameObjects(): void {\n    let o\n    if (gameObjects[this.row]) {\n      if (o = gameObjects[this.row][this.col - 1]) { // West\n        if (this.x <= o.mapX + o.width) {\n          this.x = o.mapX + o.width + 1\n        }\n      }\n      if (o = gameObjects[this.row][this.col + 1]) { // East\n        if (this.x >= o.mapX) {\n          this.x = o.mapX - 1\n        }\n      }\n    }\n    if (gameObjects[this.row - 1]) {\n      if (o = gameObjects[this.row - 1][this.col]) { // North\n        if (this.y <= o.mapY + o.height) {\n          this.y = o.mapY + o.height + 1\n        }\n      }\n      if (o = gameObjects[this.row - 1][this.col + 1]) { // North East\n        if (this.y <= o.mapY + o.height && this.x >= o.mapX) {\n          this.y = o.mapY + o.height + 1\n        }\n      }\n      if (o = gameObjects[this.row - 1][this.col - 1]) { // North West\n        if (this.y <= o.mapY + o.height && this.x <= o.mapX + o.width) {\n          this.y = o.mapY + o.height + 1\n        }\n      }\n    }\n    if (gameObjects[this.row + 1]) {\n      if (o = gameObjects[this.row + 1][this.col]) { // South\n        if (this.y >= o.mapY) {\n          this.y = o.mapY - 1\n        }\n      }\n      if (o = gameObjects[this.row + 1][this.col + 1]) { // South East\n        if (this.x >= o.mapX && this.y >= o.mapY) {\n          this.y = o.mapY - 1\n        }\n      }\n      if (o = gameObjects[this.row + 1][this.col - 1]) { // South West\n        if (this.x <= o.mapX + o.width && this.y >= o.mapY) {\n          this.y = o.mapY - 1\n        }\n      }\n    }\n  }\n\n  private updateMapPosition(): void {\n    this.row = Math.floor(this.y / CONFIG.TILE_SIZE)\n    this.col = Math.floor(this.x / CONFIG.TILE_SIZE)\n  }\n\n  public shoot(): void {\n    if (this.shooting && this.shootingCooldown <= 0) {\n      const canvasMouseX: number = Canvas.getCanvasMouseX()\n      const canvasMouseY: number = Canvas.getCanvasMouseY()\n\n      const dx = (canvasMouseX - Canvas.center.x)\n      const dy = (canvasMouseY - Canvas.center.y)\n      let xVel = dx / ( Math.abs(dx) + Math.abs(dy) )\n      let yVel = dy / ( Math.abs(dx) + Math.abs(dy) )\n\n      // TODO: Insert accuracy skill to reduce bullet motion randomness\n      // TODO: Fix the problem with different bullet speeds caused by randomness\n      const randomFactorX = Math.random() * 0.1 - 0.05\n      const randomFactorY = Math.random() * 0.1 - 0.05\n      xVel += randomFactorX\n      yVel += randomFactorY\n\n      this.projectiles.push(new Projectile(this.x, this.y, xVel, yVel))\n      this.shootingCooldown = 6\n\n      SoundFX.playSMG()\n    } else {\n      --this.shootingCooldown\n    }\n  }\n  \n  public draw(): void {\n    Canvas.drawPlayer(this)\n\t\tCanvas.drawPlayerVisionRay(this)\n\t\tCanvas.drawCrosshair()\n\t\tCanvas.drawProjectiles(this.projectiles, this.x, this.y)\n  }\n\n  public setShooting(isShooting: boolean): void {\n    this.shooting = isShooting\n  }\n}\n","import * as CONFIG from '@app/configuration/config.json'\nimport Canvas from '@app/infrastructure/Canvas'\nimport { gameObjects } from '@app/domain/Map'\n\nexport default class Projectile {\n  public speed: number = 24\n  public alive: boolean\n  constructor (\n    public x: number,\n    public y: number,\n    public directionX: number,\n    public directionY: number\n  )\n  {\n    this.alive = true\n  }\n\n  public update(playerX: number, playerY: number): void {\n    this.x += this.directionX * this.speed\n    this.y += this.directionY * this.speed\n    if (\n      this.x < playerX - Canvas.center.x || this.x > playerX + Canvas.center.x ||\n      this.y < playerY - Canvas.center.y || this.y > playerY + Canvas.center.y\n    )\n    {\n      this.alive = false\n    }\n\n    let o\n    for (let row = 0; row < gameObjects.length; ++row) {\n      for (let col = 0; col < gameObjects[row].length; ++col) {\n        o = gameObjects[row][col]\n        if (o) {\n          if (\n            this.x >= o.mapX && this.x <= o.mapX + o.width &&\n            this.y >= o.mapY && this.y <= o.mapY + o.height\n          )\n          {\n            this.alive = false\n            gameObjects[row][col] = null\n          }\n        }\n      }\n    }\n  }\n}\n","export default class Mixer {\n  private static _musicVolume   : number = 0.3\n  private static _soundFxVolume : number = 0.3\n\n  public static get musicVolume(): number {\n    return this._musicVolume\n  }\n  public static set musicVolume(vol: number) {\n    if (vol >= 0 && vol <= 1) {\n      this._musicVolume = vol\n    }\n  }\n\n  public static get soundFxVolume(): number {\n    return this._soundFxVolume\n  }\n  public static set soundFxVolume(vol: number) {\n    if (vol >= 0 && vol <= 1) {\n      this._soundFxVolume = vol\n    }\n  }\n}\n","import context from './AudioContext'\n\nexport function load(URI: string): Promise<AudioBuffer> {\n  return new Promise((resolve, reject) => {\n    const request = new XMLHttpRequest()\n    request.open('GET', URI, true)\n    request.responseType = 'arraybuffer'\n    request.onload = () => {\n      context.decodeAudioData(request.response, buffer => {\n        return resolve(buffer)\n      })\n    }\n    request.send()\n  })\n}\n","import SoundFX from './SoundFX'\n\nexport default class AudioLoader {\n  public static async load() {\n    await SoundFX.load()\n  }\n}\n"],"sourceRoot":""}